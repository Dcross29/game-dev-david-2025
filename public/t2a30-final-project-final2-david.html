<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Floor 2 - Generator</title>

<style>
body{
  margin:0;
  overflow:hidden;
  background:#222;
  font-family:arial;
  height:100vh;
  color:white;
}

#fade-in{
  position:fixed;
  inset:0;
  background:black;
  opacity:1;
  transition:opacity 2s ease;
  z-index:2000;
}
#fade-in.hide{opacity:0;}

.generator{
  position:absolute;
  bottom:50px;
  width:180px;
  height:180px;
  cursor:pointer;
}

#main-gen{ left:35%; }
#window-gen{ left:55%; }

.label{
  position:absolute;
  bottom:240px;
  font-weight:bold;
  font-size:18px;
}
#label-main{ left:35%; }
#label-window{ left:55%; }

.window-img{
  position:absolute;
  top:50px;
  width:120px;
  height:250px;
  cursor:pointer;
}

#window-left{left:50px;}
#window-center{left:calc(50% - 60px);}
#window-right{right:50px;}

.bar{
  position:absolute;
  bottom:10px;
  width:280px;
  height:22px;
  background:#333;
  border:2px solid #888;
}
.fill{
  height:100%;
  width:0%;
}

#main-bar{ left:30%; }
#main-fill{ background:lime; }

#window-bar{ left:55%; }
#window-fill{ background:cyan; }

#victory-screen,#death-screen{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.9);
  font-size:48px;
  text-align:center;
  line-height:100vh;
  display:none;
  z-index:3000;
}
</style>
</head>

<body>

<div id="fade-in"></div>

<img id="main-gen" class="generator" src="generatoroff.gif">
<div id="label-main" class="label">MAIN GENERATOR</div>

<img id="window-gen" class="generator" src="generatoroff.gif">
<div id="label-window" class="label">WINDOW POWER</div>

<img id="window-left" class="window-img" src="window.gif">
<img id="window-center" class="window-img" src="window.gif">
<img id="window-right" class="window-img" src="window.gif">

<div id="main-bar" class="bar"><div id="main-fill" class="fill"></div></div>
<div id="window-bar" class="bar"><div id="window-fill" class="fill"></div></div>

<div id="victory-screen">THE BUBBLE IS POPPED</div>
<div id="death-screen">DEATH</div>

<script>
const fadeIn = document.getElementById("fade-in");

const mainGen = document.getElementById("main-gen");
const windowGen = document.getElementById("window-gen");

const mainFill = document.getElementById("main-fill");
const windowFill = document.getElementById("window-fill");

const windows = [
  document.getElementById("window-left"),
  document.getElementById("window-center"),
  document.getElementById("window-right")
];

let mainPower = 0;
let windowPower = 0;
let gameOver = false;
let bubbleActive = false;
let bubbleWindow = null;
let bubbleTimer = null;

/* FADE IN */
window.addEventListener("load",()=>{
  requestAnimationFrame(()=>fadeIn.classList.add("hide"));
});

/* CLICK TO CHARGE MAIN GEN (SLOW) */
mainGen.onclick = () => {
  if(gameOver || bubbleActive) return;

  mainPower = Math.min(100, mainPower + 1);
  mainFill.style.width = mainPower + "%";
  mainGen.src = "generatoron.gif";

  if(mainPower >= 100){
    endGame(true);
  }
};

/* CLICK TO CHARGE WINDOW GEN (FAST) */
windowGen.onclick = () => {
  if(gameOver) return;

  windowPower = Math.min(100, windowPower + 5);
  windowFill.style.width = windowPower + "%";
  windowGen.src = "generatoron.gif";
};

/* CLOSE WINDOW — COSTS WINDOW POWER */
windows.forEach(win=>{
  win.onclick = () => {
    if(!bubbleActive || gameOver) return;
    if(windowPower < 10) return;

    windowPower -= 10;
    windowFill.style.width = windowPower + "%";

    win.src = "window.gif";
    clearTimeout(bubbleTimer);
    bubbleActive = false;
    bubbleWindow = null;
  };
});

/* SPAWN BUBBLE */
function spawnBubble(){
  if(gameOver || bubbleActive) return;

  bubbleWindow = windows[Math.floor(Math.random()*windows.length)];
  bubbleWindow.src = "windowopen.gif";
  bubbleActive = true;

  bubbleTimer = setTimeout(()=>{
    if(bubbleWindow.src.includes("windowopen")){
      endGame(false);
    }
  },1600);
}

/* END GAME */
function endGame(victory){
  gameOver = true;
  document.getElementById(victory ? "victory-screen" : "death-screen").style.display = "block";
  if(bubbleTimer) clearTimeout(bubbleTimer);
}

/* BUBBLE RATE — HIGH PRESSURE */
setInterval(()=>{
  if(Math.random() < 0.9){
    spawnBubble();
  }
},2300);
</script>

</body>
</html>
