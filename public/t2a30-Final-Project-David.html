<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Funny Little Goober</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  background: #bcbcbc;
  font-family: sans-serif;
}

#game {
  position: relative;
  width: 100vw;
  height: 100vh;
}

/* ===== HALLWAYS (VISUAL + HITBOX) ===== */
.hall {
  position: absolute;
  background: #e6e6e6;
}

/* Vertical stem of T */
#hallStem {
  width: 180px;
  height: 420px;
  left: 50%;
  bottom: 0;
  transform: translateX(-50%);
}

/* Horizontal bar of T */
#hallBar {
  width: 600px;
  height: 180px;
  top: 240px;
  left: 50%;
  transform: translateX(-50%);
}

/* ===== WALLS (IRON TEXTURE) ===== */
.wall {
  position: absolute;
  background-image: url("iron.jpg");
  background-size: cover;
}

/* Stem walls */
#wallStemL {
  width: 16px;
  height: 420px;
  left: calc(50% - 98px);
  bottom: 0;
}
#wallStemR {
  width: 16px;
  height: 420px;
  left: calc(50% + 82px);
  bottom: 0;
}

/* Bar walls */
#wallBarT {
  height: 16px;
  width: 600px;
  top: 224px;
  left: 50%;
  transform: translateX(-50%);
}
#wallBarB {
  height: 16px;
  width: 600px;
  top: 420px;
  left: 50%;
  transform: translateX(-50%);
}

/* ===== SPRITES ===== */
#player {
  position: absolute;
  width: 48px;
  height: 48px;
  left: 50%;
  bottom: 20px;
  transform: translateX(-50%);
  z-index: 5;
}

#goober {
  position: absolute;
  width: 180px; /* BIG GOOBER */
  height: 180px;
  top: 210px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 6;
}

/* ===== DOORS ===== */
.door {
  position: absolute;
  width: 100px;
  height: 150px;
  background: #aaa;
  border: 6px solid #333;
}

/* Left & Right ends of T */
#doorLeft {
  top: 255px;
  left: 40px;
}
#doorRight {
  top: 255px;
  right: 40px;
}

/* ===== DIALOGUE ===== */
#dialogueBox {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.85);
  color: white;
  padding: 16px;
  border-radius: 10px;
  max-width: 520px;
  display: none;
  z-index: 1000;
}

#choices button {
  display: block;
  margin: 8px auto;
}
</style>
</head>

<body>

<div id="game">

  <!-- HALLWAYS -->
  <div id="hallStem" class="hall"></div>
  <div id="hallBar" class="hall"></div>

  <!-- WALLS -->
  <div id="wallStemL" class="wall"></div>
  <div id="wallStemR" class="wall"></div>
  <div id="wallBarT" class="wall"></div>
  <div id="wallBarB" class="wall"></div>

  <!-- DOORS -->
  <div id="doorLeft" class="door"></div>
  <div id="doorRight" class="door"></div>

  <!-- SPRITES -->
  <img id="player" src="player.gif">
  <img id="goober" src="goober.gif">

</div>

<div id="dialogueBox">
  <div id="dialogueText"></div>
  <div id="choices"></div>
</div>

<script>
let px = window.innerWidth / 2 - 24;
let py = window.innerHeight - 80;
const speed = 4;

let locked = false;
let talked = false;
let knowsRight = false;

const halls = [hallStem, hallBar];

/* ===== MOVEMENT ===== */
document.addEventListener("keydown", e => {
  if (locked) return;

  let nx = px;
  let ny = py;

  if (e.key === "w") ny -= speed;
  if (e.key === "s") ny += speed;
  if (e.key === "a") nx -= speed;
  if (e.key === "d") nx += speed;

  if (onHall(nx, ny)) {
    px = nx;
    py = ny;
  }

  player.style.left = px + "px";
  player.style.top = py + "px";

  checkGoober();
  checkDoors();
});

/* ===== COLLISION ===== */
function onHall(x, y) {
  const p = { offsetLeft:x, offsetTop:y, offsetWidth:48, offsetHeight:48 };
  return halls.some(h => collide(p, h));
}

function collide(a, b) {
  return !(
    a.offsetLeft > b.offsetLeft + b.offsetWidth ||
    a.offsetLeft + a.offsetWidth < b.offsetLeft ||
    a.offsetTop > b.offsetTop + b.offsetHeight ||
    a.offsetTop + a.offsetHeight < b.offsetTop
  );
}

/* ===== GOOBER ===== */
function checkGoober() {
  if (talked) return;
  if (collide(player, goober)) {
    talked = true;
    locked = true;
    startDialogue();
  }
}

/* ===== DIALOGUE ===== */
function startDialogue() {
  dialogueBox.style.display = "block";
  dialogueText.textContent =
    "I am the funny little goober that tells lies.";

  choices.innerHTML = "";

  addChoice("Which door has the bubble?", () => {
    dialogueText.textContent = "The right door.";
    knowsRight = true;
    endDialogue();
  });

  addChoice("What's with your one hair?", () => {
    dialogueText.textContent = "Itâ€™s a nerve ending.";
    choices.innerHTML = "";
    addChoice("Pull it", explode);
    addChoice("Don't pull it", () => {
      dialogueText.textContent = "Then ask about the door.";
      choices.innerHTML = "";
      addChoice("Which door?", () => {
        dialogueText.textContent = "The right door.";
        knowsRight = true;
        endDialogue();
      });
    });
  });
}

function addChoice(text, fn) {
  const b = document.createElement("button");
  b.textContent = text;
  b.onclick = fn;
  choices.appendChild(b);
}

function endDialogue() {
  setTimeout(() => {
    locked = false;
    dialogueBox.style.display = "none";
  }, 600);
}

/* ===== DOORS ===== */
function checkDoors() {
  if (knowsRight && collide(player, doorRight)) {
    location.href = "levelNext.html";
  }
  if (collide(player, doorLeft)) {
    document.body.innerHTML =
      "<h1 style='text-align:center;margin-top:40vh'>Dungeon of Eternal Suffering<br>Ending: Prejudice-Filled Anti-Goober</h1>";
  }
}

/* ===== DEATH ===== */
function explode() {
  document.body.innerHTML =
    "<img src='Explode.gif' style='width:100vw;height:100vh'>";
}
</script>

</body>
</html>
