<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Funny Little Goober</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  background: #8a8a8a;
  font-family: sans-serif;
}

#game {
  position: relative;
  width: 100vw;
  height: 100vh;
}

/* ===== HALLWAYS (VISUAL + HITBOX) ===== */
.hall {
  position: absolute;
  background: #d6d6d6;
}

/* Main hallway (bottom → goober) */
#hallMain {
  width: 160px;
  height: 420px;
  left: 50%;
  bottom: 0;
  transform: translateX(-50%);
}

/* Left hallway */
#hallLeft {
  width: 360px;
  height: 160px;
  left: 0;
  top: 240px;
}

/* Right hallway */
#hallRight {
  width: 360px;
  height: 160px;
  right: 0;
  top: 240px;
}

/* ===== WALLS (visual only) ===== */
.wall {
  position: absolute;
  background: #555;
}

.wallV {
  width: 12px;
  height: 420px;
  bottom: 0;
}

#wallMainL { left: calc(50% - 86px); }
#wallMainR { left: calc(50% + 74px); }

.wallH {
  height: 12px;
  width: 360px;
}

#wallLeftT { left: 0; top: 228px; }
#wallLeftB { left: 0; top: 400px; }

#wallRightT { right: 0; top: 228px; }
#wallRightB { right: 0; top: 400px; }

/* ===== SPRITES ===== */
#player {
  position: absolute;
  width: 48px;
  height: 48px;
  left: 50%;
  bottom: 20px;
  transform: translateX(-50%);
  z-index: 5;
}

#goober {
  position: absolute;
  width: 140px; /* BIGGER */
  height: 140px;
  top: 200px;
  left: 50%;
  transform: translateX(-50%);
  z-index: 6;
}

/* ===== DOORS ===== */
.door {
  position: absolute;
  width: 90px;
  height: 140px;
  background: #999;
  border: 4px solid #444;
}

#doorLeft { top: 250px; left: 120px; }
#doorRight { top: 250px; right: 120px; }

/* ===== DIALOGUE ===== */
#dialogueBox {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: rgba(0,0,0,0.85);
  color: white;
  padding: 16px;
  border-radius: 10px;
  max-width: 520px;
  display: none;
  z-index: 1000;
}

#choices button {
  display: block;
  margin: 8px auto;
}
</style>
</head>

<body>

<div id="game">

  <!-- HALLWAYS (ALSO HITBOXES) -->
  <div id="hallMain" class="hall"></div>
  <div id="hallLeft" class="hall"></div>
  <div id="hallRight" class="hall"></div>

  <!-- WALLS -->
  <div id="wallMainL" class="wall wallV"></div>
  <div id="wallMainR" class="wall wallV"></div>

  <div id="wallLeftT" class="wall wallH"></div>
  <div id="wallLeftB" class="wall wallH"></div>

  <div id="wallRightT" class="wall wallH"></div>
  <div id="wallRightB" class="wall wallH"></div>

  <!-- DOORS -->
  <div id="doorLeft" class="door"></div>
  <div id="doorRight" class="door"></div>

  <!-- SPRITES -->
  <img id="player" src="player.gif">
  <img id="goober" src="goober.gif">

</div>

<div id="dialogueBox">
  <div id="dialogueText"></div>
  <div id="choices"></div>
</div>

<script>
let px = window.innerWidth / 2 - 24;
let py = window.innerHeight - 80;
let speed = 4;

let locked = false;
let talked = false;
let knowsRight = false;

const halls = document.querySelectorAll(".hall");

/* ===== MOVEMENT ===== */
document.addEventListener("keydown", e => {
  if (locked) return;

  let nx = px;
  let ny = py;

  if (e.key === "w") ny -= speed;
  if (e.key === "s") ny += speed;
  if (e.key === "a") nx -= speed;
  if (e.key === "d") nx += speed;

  if (onHall(nx, ny)) {
    px = nx;
    py = ny;
  }

  player.style.left = px + "px";
  player.style.top = py + "px";

  checkGoober();
  checkDoors();
});

/* ===== COLLISION ===== */
function onHall(x, y) {
  const p = { offsetLeft:x, offsetTop:y, offsetWidth:48, offsetHeight:48 };
  return [...halls].some(h => collide(p, h));
}

function collide(a, b) {
  return !(
    a.offsetLeft > b.offsetLeft + b.offsetWidth ||
    a.offsetLeft + a.offsetWidth < b.offsetLeft ||
    a.offsetTop > b.offsetTop + b.offsetHeight ||
    a.offsetTop + a.offsetHeight < b.offsetTop
  );
}

/* ===== GOOBER ===== */
function checkGoober() {
  if (talked) return;
  if (collide(player, goober)) {
    talked = true;
    locked = true;
    showDialogue();
  }
}

/* ===== DIALOGUE ===== */
function showDialogue() {
  dialogueBox.style.display = "block";
  dialogueText.textContent =
    "I am the funny little goober that tells lies.";

  choices.innerHTML = "";

  addChoice("Ask which door has the bubble", () => {
    dialogueText.textContent = "The right door.";
    knowsRight = true;
    endDialogue();
  });

  addChoice("Ask about his hair", () => {
    dialogueText.textContent = "It’s a nerve ending.";
    choices.innerHTML = "";
    addChoice("Pull it", explode);
    addChoice("Don't pull it", () => {
      dialogueText.textContent = "Then ask about the door.";
      choices.innerHTML = "";
      addChoice("Which door?", () => {
        dialogueText.textContent = "The right door.";
        knowsRight = true;
        endDialogue();
      });
    });
  });
}

function addChoice(text, fn) {
  const b = document.createElement("button");
  b.textContent = text;
  b.onclick = fn;
  choices.appendChild(b);
}

function endDialogue() {
  setTimeout(() => {
    locked = false;
    dialogueBox.style.display = "none";
  }, 600);
}

/* ===== DOORS ===== */
function checkDoors() {
  if (knowsRight && collide(player, doorRight)) {
    location.href = "levelNext.html";
  }
  if (collide(player, doorLeft)) {
    document.body.innerHTML =
      "<h1 style='text-align:center;margin-top:40vh'>Dungeon of Eternal Suffering<br>Ending: Prejudice-Filled Anti-Goober</h1>";
  }
}

/* ===== DEATH ===== */
function explode() {
  document.body.innerHTML =
    "<img src='Explode.gif' style='width:100vw;height:100vh'>";
}
</script>

</body>
</html>
